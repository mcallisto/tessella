package vision.id.tessella

import org.scalameter._
import org.scalatest.FlatSpec
import vision.id.tessella.Tessella.Tiling

class growth2Bench extends FlatSpec with TilingUtils with Loggable {

  setLogLevel("WARN")

  "Like expanding pattern 3.12*2 to 100 knowing the additions" must "execute in less than 5 seconds" in {

    val additions: List[List[Side[Int]]] = List(
      List(Side(12, 14)),
      List(Side(23, 24),
           Side(24, 25),
           Side(25, 26),
           Side(26, 27),
           Side(27, 28),
           Side(28, 29),
           Side(29, 30),
           Side(22, 23),
           Side(30, 4)),
      List(Side(30, 5)),
      List(Side(21, 23)),
      List(Side(31, 32),
           Side(32, 33),
           Side(33, 34),
           Side(34, 35),
           Side(35, 36),
           Side(36, 37),
           Side(37, 38),
           Side(29, 31),
           Side(38, 6)),
      List(Side(38, 7)),
      List(Side(28, 31)),
      List(Side(39, 40),
           Side(40, 41),
           Side(41, 42),
           Side(42, 43),
           Side(43, 44),
           Side(44, 45),
           Side(45, 46),
           Side(37, 39),
           Side(46, 8)),
      List(Side(46, 9)),
      List(Side(36, 39)),
      List(Side(47, 48),
           Side(48, 49),
           Side(49, 50),
           Side(50, 51),
           Side(51, 52),
           Side(52, 53),
           Side(53, 54),
           Side(45, 47),
           Side(54, 10)),
      List(Side(54, 11)),
      List(Side(44, 47)),
      List(Side(55, 56), Side(56, 57), Side(57, 58), Side(58, 59), Side(59, 60), Side(53, 55), Side(60, 15)),
      List(Side(60, 16)),
      List(Side(52, 55)),
      List(Side(61, 62),
           Side(62, 63),
           Side(63, 64),
           Side(64, 65),
           Side(65, 66),
           Side(66, 67),
           Side(67, 68),
           Side(59, 61),
           Side(68, 17)),
      List(Side(68, 18)),
      List(Side(58, 61)),
      List(Side(69, 70),
           Side(70, 71),
           Side(71, 72),
           Side(72, 73),
           Side(73, 74),
           Side(74, 75),
           Side(75, 76),
           Side(67, 69),
           Side(76, 19)),
      List(Side(76, 20)),
      List(Side(66, 69)),
      List(Side(77, 78), Side(78, 79), Side(79, 80), Side(80, 81), Side(81, 82), Side(75, 77), Side(82, 24)),
      List(Side(82, 25)),
      List(Side(74, 77)),
      List(Side(83, 84),
           Side(84, 85),
           Side(85, 86),
           Side(86, 87),
           Side(87, 88),
           Side(88, 89),
           Side(89, 90),
           Side(81, 83),
           Side(90, 26)),
      List(Side(90, 27)),
      List(Side(80, 83)),
      List(Side(91, 92), Side(92, 93), Side(93, 94), Side(94, 95), Side(95, 96), Side(89, 91), Side(96, 32)),
      List(Side(96, 33)),
      List(Side(88, 91)),
      List(Side(97, 98),
           Side(98, 99),
           Side(99, 100),
           Side(100, 101),
           Side(101, 102),
           Side(102, 103),
           Side(103, 104),
           Side(95, 97),
           Side(104, 34)),
      List(Side(104, 35)),
      List(Side(94, 97)),
      List(Side(105, 106),
           Side(106, 107),
           Side(107, 108),
           Side(108, 109),
           Side(109, 110),
           Side(103, 105),
           Side(110, 40)),
      List(Side(110, 41)),
      List(Side(102, 105)),
      List(Side(111, 112),
           Side(112, 113),
           Side(113, 114),
           Side(114, 115),
           Side(115, 116),
           Side(116, 117),
           Side(117, 118),
           Side(109, 111),
           Side(118, 42)),
      List(Side(118, 43)),
      List(Side(108, 111)),
      List(Side(119, 120),
           Side(120, 121),
           Side(121, 122),
           Side(122, 123),
           Side(123, 124),
           Side(117, 119),
           Side(124, 48)),
      List(Side(124, 49)),
      List(Side(116, 119)),
      List(Side(125, 126),
           Side(126, 127),
           Side(127, 128),
           Side(128, 129),
           Side(129, 130),
           Side(130, 131),
           Side(131, 132),
           Side(123, 125),
           Side(132, 50)),
      List(Side(132, 51)),
      List(Side(122, 125)),
      List(Side(133, 134),
           Side(134, 135),
           Side(135, 136),
           Side(136, 137),
           Side(137, 138),
           Side(131, 133),
           Side(138, 56)),
      List(Side(138, 57)),
      List(Side(130, 133)),
      List(Side(139, 140),
           Side(140, 141),
           Side(141, 142),
           Side(142, 143),
           Side(143, 144),
           Side(137, 139),
           Side(144, 62)),
      List(Side(144, 63)),
      List(Side(136, 139)),
      List(Side(145, 146),
           Side(146, 147),
           Side(147, 148),
           Side(148, 149),
           Side(149, 150),
           Side(150, 151),
           Side(151, 152),
           Side(143, 145),
           Side(152, 64)),
      List(Side(152, 65)),
      List(Side(142, 145)),
      List(Side(153, 154),
           Side(154, 155),
           Side(155, 156),
           Side(156, 157),
           Side(157, 158),
           Side(151, 153),
           Side(158, 70)),
      List(Side(158, 71)),
      List(Side(150, 153)),
      List(Side(159, 160),
           Side(160, 161),
           Side(161, 162),
           Side(162, 163),
           Side(163, 164),
           Side(164, 165),
           Side(165, 166),
           Side(157, 159),
           Side(166, 72)),
      List(Side(166, 73)),
      List(Side(156, 159)),
      List(Side(167, 168),
           Side(168, 169),
           Side(169, 170),
           Side(170, 171),
           Side(171, 172),
           Side(165, 167),
           Side(172, 78)),
      List(Side(172, 79)),
      List(Side(164, 167)),
      List(Side(173, 174),
           Side(174, 175),
           Side(175, 176),
           Side(176, 177),
           Side(177, 178),
           Side(171, 173),
           Side(178, 84)),
      List(Side(178, 85)),
      List(Side(170, 173)),
      List(Side(179, 180),
           Side(180, 181),
           Side(181, 182),
           Side(182, 183),
           Side(183, 184),
           Side(184, 185),
           Side(185, 186),
           Side(177, 179),
           Side(186, 86)),
      List(Side(186, 87)),
      List(Side(176, 179)),
      List(Side(187, 188),
           Side(188, 189),
           Side(189, 190),
           Side(190, 191),
           Side(191, 192),
           Side(185, 187),
           Side(192, 92)),
      List(Side(192, 93)),
      List(Side(184, 187)),
      List(Side(193, 194),
           Side(194, 195),
           Side(195, 196),
           Side(196, 197),
           Side(197, 198),
           Side(191, 193),
           Side(198, 98)),
      List(Side(198, 99)),
      List(Side(190, 193)),
      List(Side(199, 200),
           Side(200, 201),
           Side(201, 202),
           Side(202, 203),
           Side(203, 204),
           Side(204, 205),
           Side(205, 206),
           Side(197, 199),
           Side(206, 100)),
      List(Side(206, 101)),
      List(Side(196, 199)),
      List(Side(207, 208),
           Side(208, 209),
           Side(209, 210),
           Side(210, 211),
           Side(211, 212),
           Side(205, 207),
           Side(212, 106)),
      List(Side(212, 107)),
      List(Side(204, 207)),
      List(Side(213, 214),
           Side(214, 215),
           Side(215, 216),
           Side(216, 217),
           Side(217, 218),
           Side(211, 213),
           Side(218, 112)),
      List(Side(218, 113)),
      List(Side(210, 213)),
      List(Side(219, 220),
           Side(220, 221),
           Side(221, 222),
           Side(222, 223),
           Side(223, 224),
           Side(224, 225),
           Side(225, 226),
           Side(217, 219),
           Side(226, 114)),
      List(Side(226, 115)),
      List(Side(216, 219)),
      List(Side(227, 228),
           Side(228, 229),
           Side(229, 230),
           Side(230, 231),
           Side(231, 232),
           Side(225, 227),
           Side(232, 120)),
      List(Side(232, 121)),
      List(Side(224, 227)),
      List(Side(233, 234),
           Side(234, 235),
           Side(235, 236),
           Side(236, 237),
           Side(237, 238),
           Side(231, 233),
           Side(238, 126)),
      List(Side(238, 127)),
      List(Side(230, 233)),
      List(Side(239, 240),
           Side(240, 241),
           Side(241, 242),
           Side(242, 243),
           Side(243, 244),
           Side(244, 245),
           Side(245, 246),
           Side(237, 239),
           Side(246, 128)),
      List(Side(246, 129)),
      List(Side(236, 239))
    )

    val time = config(
      Key.exec.benchRuns -> 1,
      Key.verbose        -> true
    ) withWarmer {
      new Warmer.Default
      //    } withMeasurer {
      //      new Measurer.IgnoringGC
    } measure {
//    ) measure {
      val t = Tiling.fromVertex(Full.s("(3.12*2)"))
      additions.foreach(t ++= _)
    }
    assert(time.value < 5000.0)

  }

}
